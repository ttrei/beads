# Test bd dep add command
bd init --prefix test

# Create issues and capture their hash IDs from output
bd create 'First issue'
cp stdout first.txt
grep 'Created issue: test-' first.txt

bd create 'Second issue'  
cp stdout second.txt
grep 'Created issue: test-' second.txt

# Extract IDs using grep (hash IDs are test-XXXXXXXX format)
exec sh -c 'grep -oE "test-[a-z0-9]+" first.txt > first_id.txt'
exec sh -c 'grep -oE "test-[a-z0-9]+" second.txt > second_id.txt'

# Add dependency: second depends on first
exec sh -c 'bd dep add $(cat second_id.txt) $(cat first_id.txt)'
stdout 'Added dependency'

# Verify the dependency was added
exec sh -c 'bd show $(cat second_id.txt)'
stdout 'Dependencies \(1\)'
stdout 'test-'
